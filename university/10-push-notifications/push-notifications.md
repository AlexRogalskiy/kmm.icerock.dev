---
sidebar_position: 1
---

# Push notifications

## Push notifications

Push notifications - это всплывающие сообщения-уведомления, которые показываются пользователю, даже если само приложение сейчас свернуто.

Чтобы получше разобраться с тем, что такое пуши и для чего они используются, советуем прочитать [статью](https://www.sostav.ru/blogs/254470/32008/).


## Firebase Cloud Messaging
[Firebase Cloud Messaging](https://firebase.google.com/docs/cloud-messaging) (FCM) - это кроссплатформенный сервис, позволяющий интегрировать отправку push-уведомлений на iOS, Android, Web, Flutter, C++ и Unity.

<iframe src="//www.youtube.com/embed/sioEY4tWmLI" frameborder="0" allowfullscreen width="675" height="380"></iframe>
<br/>
<br/>

Чтобы использовать FCM в вашем мультиплатформенном приложении, необходимо выполнить следующие действия:
- зарегистрировать приложение в сервисе Firebase
- настроить FCM на каждой платформе
- добавить логику в общий код и на сервер

## Registration token
FCM Registration token - это специальный ключ, уникальный для каждого устройства, на котором установленно приложение, использующее FCM. Он нужен для того, чтобы идентифицировать устройство и отправлять пуши конкретно на него.

Токен не фиксированный, он может измениться в следующих случаях:
- для одной учетной записи (email, телефон и тд.), но на разных устройствах, токен будет разным
- при выходе из учетной записи мы вручную сбросим старый токен, чтобы при логине в новую учетку не приходили пуши от прошлой
- приложение удалено/переустановлено на одном и том же устройстве, токен изменится
- удалены данные приложения

Поэтому, платформа должна реагировать не только на получение токена, но и на его обновление.

## Работа платформы, общего кода и сервера

### Платформа
Платформа отвечает только за то, что реагирует на получение `FCM token-а` и его передачу в общий код.

### Общий код
В общем коде новый/обновленный токен устройства отправляется на сервер.

### Сервер
Сервер получает FCM token от общего кода и, в зависимости от логики работы приложения на нескольких устройствах:
- если приложение поддерживает использование одной учетной записи на нескольких девайсах, то сервер просто копит токены устройств, на которых используется учетная запись
- если использовать приложение можно только на одном девайсе - старый токен перезаписывается
- если произошло обновление токена конкретного устройства - обновляет его

Вся логика по отправке пушей и настройке их контента полностью происходит на сервере, чтобы была возможность оперативно что-то добавить/изменить в поведении пушей, без необходимости просить пользователей обновить приложение.
